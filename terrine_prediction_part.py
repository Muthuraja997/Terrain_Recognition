# -*- coding: utf-8 -*-
"""TERRINE PREDICTION PART.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1ZBYjxkjwuJVO-xbdFfEonvdbI_eDyXQT
"""

import tensorflow as tf

from tensorflow.keras.models import load_model
model=load_model("/content/drive/MyDrive/Save Model/terrain.h5")

from tensorflow.keras.models import load_model
from tensorflow.keras.preprocessing import image
import numpy as np
import matplotlib.pyplot as plt


training_class_labels = ['Grassy_Terrain', 'Marshy_Terrain', 'Rocky_Terrain', 'Sandy_Terrain', 'Other_Image']


class_labels = ['Grassy_Terrain', 'Marshy_Terrain', 'Other_Image', 'Rocky_Terrain', 'Sandy_Terrain']

img_path = "/content/drive/MyDrive/Colab Notebooks/terrain dataset/Rocky_Terrain/s (101).jpg"
img = image.load_img(img_path, target_size=(224, 224))
img_array = image.img_to_array(img)
img_array = img_array / 255.0
img_array = np.expand_dims(img_array, axis=0)


predictions = model.predict(img_array)


print("Shape of predictions array:", predictions.shape)
print("Predictions array:", predictions)


predicted_class_index = np.argmax(predictions)


print("Predicted class index:", predicted_class_index)


if 0 <= predicted_class_index < len(class_labels):
    predicted_class = class_labels[predicted_class_index]
    print("Predicted class:", predicted_class)
else:
    print("Error: Predicted class index is outside the valid range.")

import os


base_dir = "/content/drive/MyDrive/Colab Notebooks/terrain dataset"
grass_dir = os.path.join(base_dir, "Grassy_Terrain")
marshy_dir = os.path.join(base_dir, "Marshy_Terrain")
rocky_dir = os.path.join(base_dir, "Rocky_Terrain")
sandy_dir = os.path.join(base_dir, "Sandy_Terrain")
other_dir = os.path.join(base_dir, "Other_Image")


def count_files_in_directory(directory):
    return len([name for name in os.listdir(directory) if os.path.isfile(os.path.join(directory, name))])

print("Number of images in Grassy_Terrain:", count_files_in_directory(grass_dir))
print("Number of images in Marshy_Terrain:", count_files_in_directory(marshy_dir))
print("Number of images in Rocky_Terrain:", count_files_in_directory(rocky_dir))
print("Number of images in Sandy_Terrain:", count_files_in_directory(sandy_dir))
print("Number of images in Other_Image:", count_files_in_directory(other_dir))